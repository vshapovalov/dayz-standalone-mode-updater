MANDATORY TASK LOGGING (do this before any other work):\n1) Ensure there is a directory named `tasks/` at repo root (create if missing).\n2) Determine the next task number by listing existing files `tasks/task_*.md`:\n   - If none exist, start with task number = 1.\n   - Otherwise, set task number = (max existing number + 1).\n3) Create a new markdown file: `tasks/task_{N}.md`.\n4) Save the FULL EXACT PROMPT TEXT (verbatim) into that file, including this mandatory logging block and everything below it.\n5) Only after the file is created, proceed with implementing the task.\n\nCreate a comprehensive technical documentation file:\n- Path: docs/TECH_CONTEXT.md (create docs/ if missing)\n- Purpose: this document must fully capture project context so a new engineer (or future you) can read it once and immediately work on tasks without re-asking questions.\n\nThe document MUST include:\n1) Overview\n   - What the service does (DayZ mod updater daemon).\n   - Non-goals (no HTTP endpoints, etc.).\n2) High-level architecture\n   - Modules/packages and their responsibilities: config, state, modlist, workshop poller, steamcmd runner, local materialization, sftp sync engine, rcon countdown+shutdown, orchestrator.\n   - Data flow diagram in text (A->B->C->D plus RCON loop).\n3) Configuration contract (config.json)\n   - Full field list with types, defaults, examples.\n   - Security notes (passwords in json, file permissions).\n4) State contract (state.json)\n   - Full schema, meaning of fields, and how recovery after crash works.\n   - Stage enum meaning and transitions.\n5) Parsing specs\n   - modlist.html parsing: selectors, extracting DisplayName, Link, workshop_id.\n   - folder_slug slugify rules + fallback.\n   - modset hashing (sha256 over sorted ids).\n6) Workshop polling\n   - How we fetch time_updated (Steam Web API PublishedFileDetails), batching, rate limiting, retry policy.\n   - Logic for deciding mods_to_update_locally.\n7) SteamCMD local update\n   - Command sequence, sequential execution, success detection, failure modes.\n   - Mapping from SteamCMD workshop content dir to local_mods_root/<folder_slug> via atomic swap.\n8) SFTP sync stage\n   - Tree snapshot model, diff rules (size+mtime), operation ordering (delete conflicts -> mkdir -> upload temp+rename+setmtime -> delete extras).\n   - Partial progress rules (synced_mods per mod).\n   - What we do NOT delete (mods not in modlist).\n9) RCON countdown + shutdown\n   - Countdown 10 minutes, announce every minute with say -1 {minutes}, final_message, then #shutdown.\n   - Behavior when RCON is unavailable; resume after restart.\n   - Time rounding rule: ceil((deadline-now)/60).\n10) Orchestrator scheduling\n   - Timers/intervals, concurrency limits, phase ordering constraints.\n11) Operational notes\n   - Logging fields, where logs are written.\n   - Typical troubleshooting checklist.\n   - How to run locally, how to run integration tests (docker-compose), required env/prereqs.\n12) Roadmap / known limitations\n   - Items that might be improved later (e.g. stronger file identity, backpressure, etc.).\n\nAdditionally:\n- Add docs/README.md listing all docs files (including TECH_CONTEXT.md) and how to use them.\n- Ensure README at repo root links to docs/TECH_CONTEXT.md and explains that all Codex tasks are logged under tasks/ as task_{N}.md.\n\nOutput:\n- File tree showing docs/ additions.\n- Contents of docs/TECH_CONTEXT.md and docs/README.md (complete).
